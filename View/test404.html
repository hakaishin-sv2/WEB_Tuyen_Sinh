<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Export Table to Excel and PDF</title>
    <!-- Thêm thư viện SheetJS để xuất Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
    <!-- Thêm thư viện jsPDF và jsPDF AutoTable để xuất PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.13/jspdf.plugin.autotable.min.js"></script>
</head>
<body>

    <h1>Export Table Example</h1>

    <!-- Bảng HTML mẫu -->
    <table id="myTable" border="1">
        <tr>
            <th>Name</th>
            <th>Age</th>
            <th>Country</th>
        </tr>
        <tr>
            <td>John Doe</td>
            <td>25</td>
            <td>USA</td>
        </tr>
        <tr>
            <td>Jane Smith</td>
            <td>30</td>
            <td>UK</td>
        </tr>
        <tr>
            <td>Linda Johnson</td>
            <td>28</td>
            <td>Canada</td>
        </tr>
    </table>

    <!-- Nút xuất dữ liệu ra file Excel và PDF -->
    <button onclick="exportTableToExcel('myTable', 'data.xlsx')">Xuất ra Excel</button>
    <button onclick="exportTableToPDF('myTable', 'data.pdf')">Xuất ra PDF</button>

    <script>
        // Hàm xuất bảng ra file Excel
        function exportTableToExcel(tableID, filename = 'data.xlsx') {
            // Lấy bảng HTML
            let table = document.getElementById(tableID);
            // Chuyển đổi bảng thành workbook
            let wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
            // Xuất workbook thành file Excel
            XLSX.writeFile(wb, filename);
        }

        // Hàm xuất bảng ra file PDF
        function exportTableToPDF(tableID, filename = 'data.pdf') {
            let { jsPDF } = window.jspdf;
            let doc = new jsPDF();
            // Lấy bảng HTML và chuyển thành PDF
            doc.autoTable({ html: '#' + tableID });
            // Lưu file PDF
            doc.save(filename);
        }
    </script>

</body>
</html>
